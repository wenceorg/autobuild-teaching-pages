<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Fourier Analysis for Two-Grid Iteration #  In this exercise we want to apply what we have seen already in the lectures on smoothers to the more complicated multigrid setting. For simplicity we restrict ourselves to 1D and two levels.
We stick to the Poisson example used in the smoother example: $$\begin{array}{r c l} -\cfrac{d^2 u}{d x^2}&=&f(x),~~~x\in(0,1),\vspace*{3mm}\
u(0)=u(1) & = & 0. \end{array}$$
This time, however, we want to consider the more general case of having $N+1$ grid points, where $N:=2K$, and a resulting mesh size $h:=1/N$."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Two-Grid Iteration"><meta property="og:description" content="Fourier Analysis for Two-Grid Iteration #  In this exercise we want to apply what we have seen already in the lectures on smoothers to the more complicated multigrid setting. For simplicity we restrict ourselves to 1D and two levels.
We stick to the Poisson example used in the smoother example: $$\begin{array}{r c l} -\cfrac{d^2 u}{d x^2}&=&f(x),~~~x\in(0,1),\vspace*{3mm}\
u(0)=u(1) & = & 0. \end{array}$$
This time, however, we want to consider the more general case of having $N+1$ grid points, where $N:=2K$, and a resulting mesh size $h:=1/N$."><meta property="og:type" content="article"><meta property="og:url" content="https://teaching.wence.uk/comp4187/exercises/two-grid/"><meta property="article:modified_time" content="2020-11-10T14:28:35+00:00"><title>Two-Grid Iteration | COMP4187 – Parallel Scientific Computing II</title><link rel=manifest href=/comp4187/manifest.json><link rel=icon href=/comp4187/favicon.png type=image/x-icon><link rel=stylesheet href=/comp4187/book.min.3bea28baa3f594882b66717c01d4fc136c560878254f52bef548c7a393cf8154.css integrity="sha256-O+oouqP1lIgrZnF8AdT8E2xWCHglT1K+9UjHo5PPgVQ="><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:true},{left:"$",right:"$",display:false},{left:"\\(",right:"\\)",display:false},{left:"\\[",right:"\\]",display:true}]})});</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><div class=book-brand><img class=book-center src=/comp4187/logo.svg alt=Logo><h2><a href=/comp4187>COMP4187 – Parallel Scientific Computing II</a></h2></div><ul><li><span>Administrivia</span><ul><li><a href=/comp4187/setup/coursework/>Coursework</a></li><li><a href=/comp4187/setup/jupyter/>Jupyter</a></li></ul></li><li><span>Exercises</span><ul><li><a href=/comp4187/exercises/finite-differences/>Finite Differences</a></li><li><a href=/comp4187/exercises/two-grid/ class=active>Two-Grid Iteration</a></li><li><a href=/comp4187/exercises/norms/>Norms</a></li></ul></li><li><span>Lectures</span><ul><li><a href=/comp4187/lectures/lecture1/>Lecture 1: FD</a></li><li><a href=/comp4187/lectures/lecture2/>Lecture 2: FD</a></li><li><a href=/comp4187/lectures/lecture3/>Lecture 3: FD</a></li><li><a href=/comp4187/lectures/lecture4/>Lecture 4: Smoothers</a></li><li><a href=/comp4187/lectures/lecture5/>Lecture 5: Smoothers</a></li><li><a href=/comp4187/lectures/lecture6/>Lecture 6: Multigrid</a></li><li><a href=/comp4187/lectures/lecture7/>Lecture 7: Multigrid</a></li></ul></li><li><span>Notes</span><ul><li><a href=/comp4187/notes/overview/>Overview</a></li></ul></li><li><a href=/comp4187/acknowledgements/>Acknowledgements</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/comp4187/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Two-Grid Iteration</strong>
<label for=toc-control></label></div></header><article class=markdown><h1 id=fourier-analysis-for-two-grid-iteration>Fourier Analysis for Two-Grid Iteration
<a class=anchor href=#fourier-analysis-for-two-grid-iteration>#</a></h1><p>In this exercise we want to apply what we have seen already in the lectures on smoothers to the more complicated multigrid setting. For simplicity we restrict ourselves to 1D and two levels.</p><p>We stick to the Poisson example used in the smoother example:
$$\begin{array}{r c l}
-\cfrac{d^2 u}{d x^2}&=&f(x),~~~x\in(0,1),\vspace*{3mm}\<br>u(0)=u(1) & = & 0.
\end{array}$$</p><p>This time, however, we want to consider the more general case of having $N+1$ grid points, where $N:=2K$, and a resulting mesh size $h:=1/N$.
A step towards multigrid methods consists in the two-grid method based on coarse-grid correction.
In this particular case, we formulate the algorithm as follows:</p><ol><li>After some iteration steps using a smoother (like Jacobi), compute residual $r^{old}:= b^h-A_h u^h$. The residual and the error $e^{old}$ fulfill the residual equation $r^{old}=A e^{old}$.</li><li>Restrict the residual to the coarse grid using an operator $R$. This yields a (residual-like) vector $r^{2h}$ on the coarse grid. The coarse grid is assumed to have $K+1$ points.</li><li>Solve the residual equation $A_{2h} e^{2h} = r^{2h}$ on the coarse grid. $A_{2h}$ corresponds to the coarse-grained system that resembles $A_h$ on the fine grid.</li><li>Interpolate the resulting coarse-grid approximation of the error $e^{2h}$ to the fine grid and correct the fine-grid error $e^{new}:=e^{old}-Pe^{2h}$. The interpolation operator shall be denoted by $P$.</li></ol><p>Furthermore, we define vectors $q_h^m$ with components $(q_{h}^m)_i:=\sin(m\pi h i)$. With respect to the fine grid, we have a low frequency if $m&lt;N/2$, and a high frequency if $m\geq N/2$.\newline
In the following, we want to step through the Fourier analysis for this method and investigate the convergence behaviour, considering one cycle of this two-grid algorithm.</p><ol><li><p>Give a closed expression for $e^{new}$ which only depends on $e^{old}$ and not on $e^{2h}$ anymore. You may use the operators $R$, $P$, $A_{2h}$ and $A_h$ from above.</p></li><li><p>Define the restriction operator $R$ by injection. Show that the restriction of any error frequency $R q_h^m$ yields a low frequency, that is
$$ R q_h^m = \left{\begin{array}{r c l}
q_{2h}^m & \hbox{if} & m&lt;N/2\vspace*{3mm}\<br>-q_{2h}^{N-m} & \hbox{if} & m\geq N/2.\end{array}\right.$$</p></li><li><p>For interpolation, we want to use the linear interpolation scheme:
$$(P q^m_{2h})_i = \left{ \begin{array}{lll}
\underbrace{(q^m_{2h})_{i/2}}_{\mbox{$=(q^m_h)_i$}} & \mbox{ for } & i=2,4,\ldots,N-2 \<br>&& \<br>\frac{1}{2} \bigl( \underbrace{(q^m_{2h})_{(i-1)/2}}_{\mbox{$=(q^m_h)_{i-1}$}} +
\underbrace{(q^m_{2h})_{(i+1)/2}}_{\mbox{$=(q^m_h)_{i+1}$}} \bigr)
& \mbox{ for } & i=1,3,\ldots,N-1. \end{array} \right.$$
Use the function definitions
$$\begin{array}{ r c l}
\frac{1}{2} (\cos(\pi i)+1) & = & \left{ \begin{array}{rl}
1 & \mbox{ for } i=2,4,\ldots,N-2 \<br>0 & \mbox{ for } i=1,3,\ldots,N-1
\end{array} \right.\vspace*{3mm} \<br>\frac{1}{2} (-\cos(\pi i)+1) & = & \left{ \begin{array}{rl}
0 & \mbox{ for } i=2,4,\ldots,N-2 \<br>1 & \mbox{ for } i=1,3,\ldots,N-1
\end{array} \right. \end{array}$$
and
$$(q^{N-m}_h)_i=\sin((N-m) \pi h i) = \underbrace{\sin(N \pi h i)}_{=0}
\cos(m \pi h i) - \cos(N \pi h i) \underbrace{ \sin(m \pi h i) }_{= (q^m_h)_i } = -\cos(\pi i)(q^m_h)_i$$
to re-write the interpolated coarse grid frequency $P q_{2h}^m$ as
$$ P q_{2h}^m = a_m\cdot q_h^m + b_m\cdot q_h^{N-m}$$
with (frequency-dependent) constants $a_m, b_m$. What does the latter equation tell us about the frequency of the interpolated function $P q_{2h}^m$?</p></li><li><p>Putting the results from prolongation and restriction together, we can derive by further computation (not discussed in the exercise) that
$$ PA_{2h}^{-1}RA_hq_h^m=\left{ \begin{array}{lll}
q^m_h
-\frac{(1-\cos(m \pi h))^2}{\sin(m \pi h)^2} q^{N-m}_h &
\mbox{ if } & m &lt; \frac{N}{2} \[0.5ex]
-\frac{(1-\cos(m \pi h))^2}{\sin(m \pi h)^2} q^{N-m}_h +
q^m_h
& \mbox{ if } & m \ge \frac{N}{2} \end{array} \right. \<br>= q^m_h - \frac{(1-\cos(m \pi h))^2}{\sin(m \pi h)^2} q^{N-m}_h$$
Assume that the initial error is a linear combination of two sines: $e^{old} = x_1q_h^m + x_2q_h^{N-m}$ with $m&lt;N/2$. Express $PA_{2h}^{-1}RA_he^{old}$ in terms of $q_h^m$ and $q_h^{N-m}$,
a $2\times 2$-matrix $B_m$, and the vector $(x_1,x_2)^T$. That is, find a representation
$$PA_{2h}^{-1}RA_he^{old} = \begin{pmatrix}
q_h^m & q_h^{N-m}
\end{pmatrix}
B_m
\begin{pmatrix}
x_1 \ x_2
\end{pmatrix}.$$
With this in mind, we can simplify the analysis with a change of basis. Let
$$ Q = (q_h^1, q_h^{N-1}, q_h^2, q_h^{N-2}, \dots, q_h^{K-1}, q_h^{N-K+1}, q_h^{K}).$$
As this matrix is invertible, we can find a vector $x^{new}$ with $e^{new} = Qx^{new}$ and a vector $x^{old}$ with $e^{old} = Qx^{old}$.
The entry $(x^{old})_i$ can be interpreted as the weight of the frequency in the i-th column of $Q$.
If we left-multiply $e^{new}$ with $Q^{-1}$ we have
$$ x^{new} = Q^{-1}e^{new} = Q^{-1}e^{old} - Q^{-1}PA_{2h}^{-1}RA_he^{old} = x^{old} - C x^{old} = (I - C) x^{old}.$$
That is, we have found a frequency mapping $x \mapsto (I-C)x$ and may directly work with the error&rsquo;s frequency components instead with the error itself.</p></li></ol><p>Determine the matrix $C$. ($C$ will be block diagonal and consist of blocks $B_m$.)</p><ol start=4><li>In order to remove high frequency errors, we apply two Jacobi iterations before ({\textit pre-smoothing}) and after ({\textit post-smoothing}) the coarse-grid correction scheme.
Following the Fourier analysis from the finite-difference exercise for the basis vectors $(q_h^m)_{m=1,\dots,N-1}$, one weighted Jacobi iteration ($\omega=1/2$) corresponds to the update rule
(again working on the error&rsquo;s frequency components with the same ordering as in 3.
$$
x \mapsto M_f x.
$$
I.e. for the frequency pair $m$ and $N-m$ we obtain
\begin{displaymath}
\left(\begin{array}{c}
x_1\<br>x_2\end{array}\right) \rightarrow \left(\begin{array}{c c}
\frac{1}{2}\left(1+\cos(m\pi h)\right) & 0\<br>0 & \frac{1}{2}\left(1-\cos(m\pi h)\right)
\end{array}\right)
\left(\begin{array}{c}
x_1\<br>x_2\end{array}\right)
\end{displaymath}</li></ol><p>Because $C$ is a block diagonal matrix and $M_f$ is diagonal, we may limit the discussion to frequency pairs. The general results then follow easily.</p><p>Give an estimate for the maximum eigenvalue of the overall solver operations, that is pre-smoothing $\rightarrow$ restriction $\rightarrow$ coarse-grid correction $\rightarrow$ interpolation $\rightarrow $post-smoothing.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/wenceorg/comp4187/commit/d8a5c368c5f1bca2aca77f9f2c1f478353a9c508 title="Last modified by Anne Reinarz | November 10, 2020" target=_blank rel=noopener><img src=/comp4187/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 10, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/wenceorg/comp4187/edit/master/site/content/exercises/two-grid.md target=_blank rel=noopener><img src=/comp4187/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><div class="flex flex-wrap align-right"><p>© 2020&ndash; <a href=mailto:lawrence@wence.uk>Lawrence Mitchell</a>, <a href=https://annereinarz.github.io>Anne Reinarz</a> & <a href=https://www.dur.ac.uk/>Durham University</a>.</p><p><a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/><img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by-sa/4.0/88x31.png></a>
This work is licensed under a <a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/>Creative
Commons Attribution-ShareAlike 4.0 International License</a>.</p></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>